# Google Threat Intelligence Feeds Downloader

This Python script provides a command-line interface to download minutely feed batches and artifacts from Google Threat Intelligence. It allows users to retrieve data for various threat types, including files, domains, IP addresses, and URLs, and to download specific artifacts like PCAP, memory dumps, and event logs (EVTX) from sandbox analyses.

*Gen AI Disclosure: This project was generated by Gemini Enterprise with final review and edits by a human. The underlying code was tested and is maintained by humans.*

## Features

**API Key Prompt:** Securely prompts the user for their Google Threat Intelligence API key.

**Menu-Driven Interface:** Offers a simple, interactive menu to select which feeds or artifacts to download.

**Individual and Batch Downloads:** Retrieve a single feed batch or all available batches simultaneously.

**Sample Downloads:** For file intelligence and sandbox artifacts (PCAP, memdump, EVTX), provides the option to download a small sample (2 files) for demonstration or all available files.

**Automated Time Handling:** Automatically calculates the correct timestamp for the most recent available batch, respecting the 60-minute lag.

**Error Handling:** Gracefully handles API errors, network issues, and missing feed batches (404 Not Found).

**Output Organization:** Saves downloaded feeds and artifacts into a dedicated ```feeds_output``` directory.

## Prerequisites

**Python 3.x:** The script is written in Python 3.

**Requests library:** Used for making HTTP requests to the Google Threat Intelligence API.

**Google Threat Intelligence License:** Access to these feeds requires specific licenses. Please ensure your API key has the necessary permissions.

## Installation
1. Clone or download the script: Save the provided Python code as ```gti_feed_downloader.py```.

1. Create a virtual environment (recommended):

    ```Bash
    python3 -m venv venv
    source venv/bin/activate
    ```

1. Install the required dependencies:

    ```Bash
    pip install requests
    ```

## Usage
1. Run the script from your terminal:

    ```Bash
    python gti_feed_downloader.py
    ```

1. Enter your API Key: The script will first prompt you for your Google Threat Intelligence API key.

1. Select an option from the menu:
A menu will appear with options to download specific feeds or artifacts.

    ```
    --- Google Threat Intelligence Feed Menu ---
    1. Get a minutely batch for File Intelligence
    2. Get a minutely batch for Sandbox Analyses
    3. Get a minutely batch for Domain Intelligence
    4. Get a minutely batch for IP Intelligence
    5. Get a minutely batch for URL Intelligence
    6. Get a minutely batch for ALL feeds

    --- File Artifacts ---
    7. Download files from the latest File Intelligence feed

    --- Sandbox Artifacts ---
    8. Download available PCAP files from the latest Sandbox Analyses feed
    9. Download available Memory Dump files from the latest Sandbox Analyses feed
    10. Download available EVTX files from the latest Sandbox Analyses feed
    11. Exit

    Enter your choice: 
    ```

    - For options **1-6**, the script will download the corresponding compressed feed file and save it as a ```.jsonl``` file in the ```feeds_output``` directory.

    - For options **7-10**, the script will first download the relevant feed (File Intelligence for option 7, Sandbox Analyses for 8-10), then ask if you want to download a sample of 2 files or all available files before saving them. Downloaded files from the file feed will have a ```.download``` extension, while sandbox artifacts (PCAP, memdump, EVTX) will have a ```.bin``` extension.

## Output
All downloaded files are saved in a directory named ```feeds_output``` in the same location as the script.

**Feeds:** ```feeds_output/{feed_endpoint}_YYYYMMDDhhmm.jsonl```

- Example: ```feeds_output/files_202407311400.jsonl```

**File Artifacts:** ```feeds_output/{SHA256_hash}.download```

- Example: ```feeds_output/a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2.download```

**Sandbox Artifacts:** ```feeds_output/{SHA256_hash}_{file_type}.bin```

- Example: ```feeds_output/a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2_pcap.bin```

## Troubleshooting

### Error 403 Forbidden
If you encounter ```403 Forbidden``` errors, please verify your license status.